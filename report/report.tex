\documentclass[10pt, a4paper,openany]{article}
\usepackage[italian]{babel}
\usepackage[T1]{fontenc}
\usepackage[table]{xcolor}
\usepackage{float}
\restylefloat{table,figure}
\usepackage{graphicx}	
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{url}
\usepackage[ruled,vlined]{algorithm2e}
\geometry{a4paper,top=2cm,bottom=2cm,left=3cm,right=3cm,%
	heightrounded,bindingoffset=5mm}
\usepackage{amssymb}
\usepackage{amsthm}


\begin{document}

\begin{center}
\huge\textbf{YouTube al tempo del Covid-19}

Un'analisi dei video in tendenza
\end{center}

\begin{center}
Gabriele Celeri, Federico Luzzi,  Marco Peracchi, Christian Uccheddu
\end{center}

\hrule
\vspace{0.5cm}

\begin{center}\textbf{{Introduzione e obiettivi} (DA RISCRIVERE)}
\\

In questo lavoro l'obiettivo è quello di capire come un video di Youtube riesca ad avere successo. Per raggiungere questo scopo abbiamo deciso di analizzare i video di Youtube che si trovano in trending nelle varie ore delle giornata, studiandone caratteristiche, categorie di appartenenza, insieme a visualizzazioni, likes, dislikes, commenti e altro.
L'obiettivo è anche quello di comprendere come cambiano le caratteristiche nei vari paesi, e cosa serve per avere successo in ognuno di questi.

\vspace{0.5cm}
\hrule
\end{center}
\textbf{IO SCRIVEREI TUTTO AL PRESENTE CON MAGARI COME SOGGETTO "NOI" (ALTRIMENTI SI PUÒ SCRIVERE IMPERSONALE) [fede]}

\input{00_scelta_strumenti.tex}
\input{01_raccolta_dati.tex}
  
\subsection*{Qualità dati}
Avendo una grande mole di dati ci siamo dovuti anche occupare di verificare la pulizia o meno del nostro dataset. Per prima cosa abbiamo notato che non c'era presenza di Missing Values, questo è stato di per sé una grande fortuna poiché di solito il Missing Replacement è una operazione molto lunga.  Ci sono state però due problematiche principali che abbiamo dovuto affrontare:
\begin{itemize}
	\item Ridondanza: Questo problema è nato dal fatto che i trending di Youtube sono stati presi ogni mezz'ora, con il risultato di avere molti dati simili riguardanti le stesse fasce della giornata. 
	\item Buchi: Questo problema è nato dal fatto che Google non permette di avanzare troppe richieste per la presa dati nella stessa giornata, per arginare questo problema abbiamo utilizzato 3 chiavi diverse con cui mandare le richieste a Google in modo tale da coprire la maggior parte della giornata. Ci sono stati però dei punti in cui la presa dati non è riuscita. Il metodo che abbiamo utilizzato per riempire quei buchi è stato quello di duplicare i dati della presa dati precedente. Questo metodo è stato possibile poiché la presa dati è stat effettuata in intervalli di tempo in cui i dati non vengono modificati significativamente.
	
\end{itemize}

\subsection*{Integrazione dati}
	Per poter rispondere alle nostre domande di ricerca abbiamo dovuto effettuare un'integrazione tra i dati dei video di Youtube e i dati relativi ai contagi giornalieri di covid-19. Il merge l'abbiamo effettuato prima del loro caricamento su MongoDB. Lo script che implementa la nostra integrazione è \textit{merge\_to\_mongo.py}. 
	
	Sostanzialmente applichiamo un'\textbf{integrazione temporale} considerando, per ciascun video, il \textbf{timestamp} della rilevazione e il paese in cui il video è presente (\textbf{country\_name}). Ricerchiamo il corrispettivo (timestamp, country\_name) nella base dati covid e generiamo un nuovo documento con tutte le informazioni del video di Youtube aggiungendo un sotto documento \textit{covid} con tutti i dati relativi ai contagi avvenuti quel giorno in quello stato. A questo punto i documenti vengono caricati su MongoDB.
	
	Un problema riscontrato durante l'integrazione è stato che la rilevazione viene effettuata con il fuso orario di Greenwich GMT, però ciascun paese ha uno o più fusi orari differenti. Pertanto abbiamo corretto i timestamp in base al fuso orario della capitale di ciascun paese. Nel dettaglio visualizzare il file \textit{country\_name.json}.
	
	L'operazione di integrazione complessivamente richiede:
	\begin{itemize}
		\item senza sharding: 1419 s (23,6 min circa)
		\item con sharding: 1431 s (24 min circa)
	\end{itemize}
\subsection*{Espressione regolare}
	Per poter distinguere quali video possono essere considerati legati al covid-19 o meno, abbiamo definito la seguente espressione regolare:
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.95\linewidth]{pics/er.png}
	\end{figure}

	Abbiamo cercato di includere tutte le parole legate al contesto del Covid-19 e la loro traduzione in tutte le lingue dei paesi del nostro studio.
	
	Questa espressione regolare l'abbiamo applicata sia analizzando i titoli dei video, sia analizzando i tags scelti per descrivere il video. L'applicazione è avvenuta tramite le seguenti query:
	\begin{enumerate}
		\item setting tutti video come non covid (sia per titolo che per tags):
		
			db.video\_merge.update(\{\},\{\$set : \{covid\_tags : false, covid\_title : false\}\},\{multi : true\})
		
		\item setting true tutti i video che hanno almeno un tag che rispetta l'espressione regolare (REGEX):
		
			db.video\_merge.update(\{tags : \{\$in : [REGEX]\}\}, \{\$set : \{covid\_tags: true\}\}, \{multi : true\})
		
		\item setting true tutti i video il cui titolo rispetta l'espressione regolare (REGEX):
		
			db.video\_merge.update(\{title : \{\$in : [REGEX]\}\}, \{\$set : \{covid\_title: true\}\}, \{multi : true\})
	\end{enumerate}

\subsection*{Scalabilità dell'algoritmo}

Visto che una delle V che abbiamo deciso di usare concernenti i Big Data è stata quella relativa al volume dobbiamo occuparci di vedere come si comporta la nostra elaborazione dati con volumi di dati sempre crescenti. Abbiamo deciso di implementare lo \textbf{Sharding} su MongoDB. In particolare, abbiamo deciso di costruire 3 shard replica group formati da 3 repliche dello shard in modo da garantire la ridondanza nel caso di guasti e la frammentazione per rendere più efficienti le query. La chiave di sharding scelta è quella del campo "\textbf{country\_name}" perché le query per rispondere alle nostre domande vengono fatte sul singolo paese. Questo approccio è stato pensato anche nell'ottica di dividere la grande mole di dati in server disposti in ciascun paese. 

Segue lo schema logico applicato:
\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\linewidth]{pics/sharding.png}
	\caption{pipeline sharding}
\end{figure}

QUERY ANALISI:


%Per farlo ci occupiamo di effettuare la nostra analisi su partizionamenti sempre maggiori del nostro dataset e registriamo il tempo di esecuzione del nostro programma, effettuiamo poi una semplice regressione per vedere di che tipo di crescita stiamo parlando, ovviamente più la crescita è minore più il nostro algoritmo scala bene per volumi di dati maggiori. Presentiamo di seguito la registrazione dei tempi rispetto al partizionamento dei dati. 

%\begin{figure}[H]
%	\centering
%	\includegraphics[height=0.3 \linewidth]{pict/times.png}
%	\caption{Crescita del tempo di esecuzione rispetto all'aumentare del partizionamento.}
%\end{figure}

\section*{Visualizzazione}
Per la scelta delle visualizzazione abbiamo dovuto pensare per prima cosa a delle domande di ricerca a cui rispondere. Le domande che ci siamo posti sono le seguenti:
\begin{itemize}
	\item Variazione della tipologia di video in tendenza da periodo pre covid-19 a periodo covid-19
	\item È vero che la fruizione di video su Youtube riguardanti i contagi di Covid-19 segue l'andamento dei dati sull'epidemia?
\end{itemize}

\subsection*{Scelta features}
Per rispondere in modo coerente alle nostre domande di ricerca abbiamo deciso di concentrarsi sulle seguenti features del nostro dataset.
\begin{itemize}
	\item Numero di visualizzazioni.
	\item Numero di like.
	\item Numero di dislike.
	\item Numero di commenti.
	\item Numero di iscritti ad un canale.
\end{itemize}

A partire da queste feature abbiamo inoltre definito un indice fittizio che abbiamo deciso di denominare \textit{Indice di partecipazione.} Questo indice ci è servito per capire quale fosse il video con il maggior numero di partecipazioni rispetto al numero di visualizzazioni ottenute in modo da poter capire quanto le tendenze siano influenzate da questo indice. In particolare:
\[ I = \frac{like+dislike+comment}{views}\]
\subsection*{Scelta della visualizzazione}
La visualizzazione che meglio si presta a dati con natura fortemente temporale è una visualizzazione a righe. Per arricchire la visualizzazione di contenuti abbiamo inserito ulteriori caratteristiche a questa visualizzazione. In particolare la visualizzazione è composta nel seguente modo:
%\begin{figure}[H]
%	\centering
%	\includegraphics[height=0.3 \linewidth]{pict/prima.png}
%	\caption{Prima infografica.}
%\end{figure}
In questo caso 
\subsection*{Valutazione della qualità}
La valutazione della qualità della nostra infografica si è articolata in tre macro passaggi:

\paragraph{User Test} Durante questa fase ci siamo occupati di sottoporre la nostra infografica a 3 persone lasciando completa libertà di esplorazione. Le varie esplorazioni sono state registrate in modo da far sì che potessero emergere le diverse problematiche di cui non ci siamo accorti in fase di realizzazione delle infografiche. Esponiamo le problematiche emerse durante questa fase di valutazione e le correzioni applicate:

\begin{itemize}
	\item Problema 1: soluzione 1
	\item Problema 2: soluzione 1
	\item Problema 3: soluzione 1
\end{itemize}
\paragraph{Risultati dei task} Durante questa fase ci siamo occupati di sottoporre tre diverse richieste a 24 utenti che dovevano essere soddisfatte esplorando interattivamente la nostra infografica. In particolare i task da risolvere sono stati i seguenti:
\begin{itemize}
	\item Qual'è il video con l'indice di partecipazione più alto in Italia?
	\item Qual'è il video con l'indice di partecipazione più alto tra tutti i paesi?
	\item Che categoria di video dovresti utilizzare se volessi creare contenuti che piacciono in USA?
\end{itemize}Ci siamo occupati di registrare i tempi in cui gli utenti riuscivano a completare questu obiettivi e abbiamo visualizzato questi record nei seguenti violin plot:
%\begin{figure}[H]
%	\centering
%	\includegraphics[height=0.3 \linewidth]{pict/violin_plot.png}
%	\caption{Tempi di completamento dei task.}
%\end{figure}
Questa visualizzazione è utile per capire se le nostre infografiche sono troppo dispersive o riescono a centrare gli obietivi facilmente.
\paragraph{Questionari} Per quanto riguarda quest'ultima fase ci siamo occupati di rivolgere un questionario della valutazione della qualità a 24 persone. In particolare il questionario è stato articolato nella seguente maniera:
\begin{itemize}
	\item Come valuti la chiarezza dell' infografica?
	\item Come valuti l'utilità dell'infografica?
	\item Quanto valuti la bellezza dell'infografica?
	\item Come valuti l'intuitività dell'infografica?
	\item Quanto è stata informativa l'infografica?
	\item Come valuti complessivamente l'infografica?
\end{itemize}
Le risposte sono state registrate grazie al tool: Questionari di Google. Una volta registrate le risposte ci siamo occupati di vedere se la valutazione complessiva dell'infografica fosse coerente con una ricostruzione complessiva data dalla regressione con i coefficienti di Cabitza-Locoro.
%\begin{figure}[H]
%	\centering
%	\includegraphics[height=0.3 \linewidth]{pict/box_plot.png}
%	\caption{Dispersione delle risposte del questionario.}
%\end{figure}
E' stato comodo usare un box plot per la registrazione di queste risposte poiché la media è un indicatore di tendenza centrale e non fornisce alcuna informazione sulla distribuzione di questi dati.
Per quanto riguarda invece della coerenza della valutazione complessiva rispetto alla ricostruzione data dai coefficienti abbiamo avuto la seguente distribuzione:
%\begin{figure}[H]
%	\centering
%	\includegraphics[height=0.3 \linewidth]{pict/regressione.png}
%	\caption{$R^{2} = 0.75$.}
%\end{figure}


\end{document}