<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module scraper_consumer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>scraper_consumer</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:c%3A%5Cusers%5Cfede9%5Cdocuments%5Cgithub%5Cyoutube_trending_analysis%5Cscraper%5Cscraper_consumer.py">c:\users\fede9\documents\github\youtube_trending_analysis\scraper\scraper_consumer.py</a></font></td></tr></table>
    <p><tt>Scraper&nbsp;Kafka&nbsp;consumer&nbsp;per&nbsp;leggere&nbsp;i&nbsp;dati&nbsp;dei&nbsp;video&nbsp;in&nbsp;tendenza&nbsp;di&nbsp;youtube&nbsp;tramite<br>
Kafka.&nbsp;Li&nbsp;formatta&nbsp;correttamente,&nbsp;li&nbsp;salva&nbsp;in&nbsp;formato&nbsp;json&nbsp;e&nbsp;carica&nbsp;su&nbsp;db&nbsp;mongoDB.<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;-o:&nbsp;output&nbsp;directory<br>
&nbsp;&nbsp;&nbsp;&nbsp;-kp:&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;dove&nbsp;trovare&nbsp;il&nbsp;file&nbsp;della&nbsp;API&nbsp;key<br>
&nbsp;&nbsp;&nbsp;&nbsp;-co:&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;dove&nbsp;trovare&nbsp;il&nbsp;file&nbsp;dei&nbsp;country&nbsp;codes<br>
&nbsp;&nbsp;&nbsp;&nbsp;-ch:&nbsp;&nbsp;&nbsp;&nbsp;kafka&nbsp;topic&nbsp;dove&nbsp;scrive&nbsp;i&nbsp;dati&nbsp;(default="yt_video")<br>
&nbsp;&nbsp;&nbsp;&nbsp;-ho:&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;dell'host&nbsp;del&nbsp;server&nbsp;mongoDB&nbsp;(default="localhost")<br>
&nbsp;&nbsp;&nbsp;&nbsp;-p:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numero&nbsp;della&nbsp;porta&nbsp;in&nbsp;cui&nbsp;comunica&nbsp;il&nbsp;server&nbsp;mongoDB&nbsp;(default=27017)<br>
&nbsp;&nbsp;&nbsp;&nbsp;-u:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;utente&nbsp;del&nbsp;server&nbsp;mongoDB&nbsp;(default="admin")<br>
&nbsp;&nbsp;&nbsp;&nbsp;-pass:&nbsp;&nbsp;password&nbsp;del&nbsp;server&nbsp;mongoDB&nbsp;(default="DataMan2019!")<br>
&nbsp;&nbsp;&nbsp;&nbsp;-db:&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;del&nbsp;database&nbsp;mongoDB&nbsp;in&nbsp;cui&nbsp;salvare&nbsp;i&nbsp;dati&nbsp;(default="yt_data")<br>
&nbsp;&nbsp;&nbsp;&nbsp;-col:&nbsp;&nbsp;&nbsp;nome&nbsp;della&nbsp;collezione&nbsp;mongoDB&nbsp;nella&nbsp;quale&nbsp;inserire&nbsp;i&nbsp;dati&nbsp;(default="videos")</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="argparse.html">argparse</a><br>
<a href="json.html">json</a><br>
</td><td width="25%" valign=top><a href="os.html">os</a><br>
<a href="requests.html">requests</a><br>
</td><td width="25%" valign=top><a href="sched.html">sched</a><br>
<a href="sys.html">sys</a><br>
</td><td width="25%" valign=top><a href="time.html">time</a><br>
</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-consume"><strong>consume</strong></a>(db, col)</dt><dd><tt>Esegue&nbsp;tutti&nbsp;i&nbsp;passaggi&nbsp;per&nbsp;leggere&nbsp;da&nbsp;Kafka&nbsp;i&nbsp;dati,&nbsp;salvarli&nbsp;su&nbsp;MongoDB&nbsp;e&nbsp;in&nbsp;json<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;db:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;database&nbsp;mongo<br>
&nbsp;&nbsp;&nbsp;&nbsp;col:&nbsp;&nbsp;&nbsp;&nbsp;collection&nbsp;mongo</tt></dd></dl>
 <dl><dt><a name="-find_category_name"><strong>find_category_name</strong></a>(category_id, categorys)</dt><dd><tt>Restituisce&nbsp;il&nbsp;nome&nbsp;della&nbsp;categoria&nbsp;per&nbsp;esteso<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;category_id:&nbsp;&nbsp;&nbsp;&nbsp;codice&nbsp;categoria&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;categorys:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dizionario&nbsp;dei&nbsp;codici&nbsp;categoria&nbsp;con&nbsp;nom<br>
@returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;esteso&nbsp;categoria</tt></dd></dl>
 <dl><dt><a name="-find_country_name"><strong>find_country_name</strong></a>(country_code, c_gmt)</dt><dd><tt>Restituisce&nbsp;il&nbsp;nome&nbsp;per&nbsp;esteso&nbsp;del&nbsp;country<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;country_code:&nbsp;&nbsp;&nbsp;codice&nbsp;paese&nbsp;per&nbsp;il&nbsp;quale&nbsp;cercare&nbsp;il&nbsp;nome&nbsp;esteso<br>
&nbsp;&nbsp;&nbsp;&nbsp;c_gmt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dizionario&nbsp;dei&nbsp;codici&nbsp;paesi&nbsp;con&nbsp;nomi&nbsp;e&nbsp;fusi&nbsp;orario<br>
@return<br>
&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;esteso</tt></dd></dl>
 <dl><dt><a name="-fix_timestamp"><strong>fix_timestamp</strong></a>(timestamp, country_code, c_gmt)</dt><dd><tt>Sistema&nbsp;il&nbsp;timestamp&nbsp;in&nbsp;base&nbsp;al&nbsp;fuso&nbsp;orario&nbsp;del&nbsp;paese&nbsp;in&nbsp;questione<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;&nbsp;timestamp&nbsp;della&nbsp;rilevazione<br>
&nbsp;&nbsp;&nbsp;&nbsp;country_code:&nbsp;&nbsp;&nbsp;codice&nbsp;paese&nbsp;per&nbsp;calcolare&nbsp;fuso&nbsp;orario<br>
&nbsp;&nbsp;&nbsp;&nbsp;c_gmt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dizionario&nbsp;dei&nbsp;codici&nbsp;paesi&nbsp;con&nbsp;nomi&nbsp;e&nbsp;fusi&nbsp;orario<br>
@return:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;timestamp&nbsp;formattato&nbsp;correttamente</tt></dd></dl>
 <dl><dt><a name="-get_data"><strong>get_data</strong></a>(clientMongo, database='yt_data', collection='videos')</dt><dd><tt>Rimane&nbsp;in&nbsp;ascolto&nbsp;su&nbsp;kafka&nbsp;e&nbsp;appena&nbsp;arrivano&nbsp;dei&nbsp;dati&nbsp;li&nbsp;consuma&nbsp;<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;clienMongo:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;istanza&nbsp;di&nbsp;mongo&nbsp;client<br>
&nbsp;&nbsp;&nbsp;&nbsp;database:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;database<br>
&nbsp;&nbsp;&nbsp;&nbsp;collection:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;collezione</tt></dd></dl>
 <dl><dt><a name="-get_videos"><strong>get_videos</strong></a>(items, service)</dt><dd><tt>Esegue&nbsp;la&nbsp;trasformazione&nbsp;della&nbsp;lista&nbsp;di&nbsp;dizionari&nbsp;sui&nbsp;video&nbsp;in&nbsp;input&nbsp;in&nbsp;lista&nbsp;di&nbsp;liste<br>
per&nbsp;il&nbsp;csv&nbsp;in&nbsp;output<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;items:&nbsp;&nbsp;lista&nbsp;di&nbsp;dizionari<br>
&nbsp;&nbsp;&nbsp;&nbsp;service:&nbsp;&nbsp;&nbsp;&nbsp;informazioni&nbsp;di&nbsp;timestamp&nbsp;e&nbsp;country&nbsp;da&nbsp;appendere&nbsp;al&nbsp;dizionario<br>
@return:<br>
&nbsp;&nbsp;&nbsp;&nbsp;lines:&nbsp;&nbsp;lista&nbsp;di&nbsp;liste</tt></dd></dl>
 <dl><dt><a name="-setup"><strong>setup</strong></a>(code_path, host, port, user, passw)</dt><dd><tt>Inizializzazione&nbsp;dei&nbsp;codici&nbsp;dei&nbsp;paesi&nbsp;da&nbsp;cui&nbsp;voglio&nbsp;scaricare&nbsp;i&nbsp;dati&nbsp;e&nbsp;del&nbsp;client&nbsp;mongoDB<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;code_path:&nbsp;&nbsp;path&nbsp;in&nbsp;cui&nbsp;ho&nbsp;i&nbsp;codici&nbsp;dei&nbsp;paesi&nbsp;dello&nbsp;scraping<br>
&nbsp;&nbsp;&nbsp;&nbsp;host:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host&nbsp;del&nbsp;server&nbsp;mongoDB<br>
&nbsp;&nbsp;&nbsp;&nbsp;port:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;porta&nbsp;del&nbsp;server&nbsp;mongoDB<br>
&nbsp;&nbsp;&nbsp;&nbsp;user:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nome&nbsp;utente&nbsp;del&nbsp;server&nbsp;mongoDB<br>
&nbsp;&nbsp;&nbsp;&nbsp;passw:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;per&nbsp;accedere&nbsp;all'utente&nbsp;mongoDB<br>
@return:<br>
&nbsp;&nbsp;&nbsp;&nbsp;country_codes:&nbsp;&nbsp;codici&nbsp;paesi&nbsp;scraping<br>
&nbsp;&nbsp;&nbsp;&nbsp;client:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;mongoDB</tt></dd></dl>
 <dl><dt><a name="-write_to_file"><strong>write_to_file</strong></a>(output_data, pos)</dt><dd><tt>Si&nbsp;occupa&nbsp;della&nbsp;scrittura&nbsp;su&nbsp;file&nbsp;json&nbsp;della&nbsp;lista&nbsp;di&nbsp;dizionari&nbsp;dei&nbsp;video<br>
@params:<br>
&nbsp;&nbsp;&nbsp;&nbsp;output_data:&nbsp;&nbsp;&nbsp;&nbsp;lista&nbsp;di&nbsp;dizionari&nbsp;da&nbsp;salvare<br>
&nbsp;&nbsp;&nbsp;&nbsp;pos:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indice&nbsp;per&nbsp;distinguere&nbsp;i&nbsp;diversi&nbsp;files</tt></dd></dl>
</td></tr></table>
</body></html>